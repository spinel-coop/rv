name: Smoke Tests (Baseline)

on:
  schedule:
    - cron: "0 10 * * *" # Nightly, 10:00 UTC / 02:00 Pacific
  workflow_dispatch:

permissions: read-all

jobs:
  lobsters:
    name: baseline-lobsters
    runs-on: ubuntu-latest
    steps:
      - name: Check out repo
        uses: actions/checkout@v6

      - name: Clone lobsters
        run: git clone --depth 1 https://github.com/lobsters/lobsters.git

      - name: Install native dependencies
        run: |
          sudo apt-get update
          sudo apt-get install -y --no-install-recommends \
              build-essential git curl ca-certificates pkg-config \
              libyaml-dev libmariadb-dev libsqlite3-dev libclang-dev

      - name: Set up Ruby
        uses: ruby/setup-ruby@v1
        with:
          working-directory: lobsters

      - name: Run bundle install
        working-directory: lobsters
        run: bundle install
